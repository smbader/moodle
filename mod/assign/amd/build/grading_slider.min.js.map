{"version":3,"file":"grading_slider.min.js","sources":["../src/grading_slider.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Javascript controller for the \"Grading\" panel at the right of the page.\n *\n * @module     mod_assign/grading_slider\n * @class      GradingSlider\n * @copyright  2019 Steve Bader <smbader@ncsu.edu>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n * @since      3.6\n */\ndefine(['jquery', 'mod_assign/grading_events', 'mod_assign/grading_panel',\n        'mod_assign/grading_review_panel', 'mod_assign/grading_actions'],\n       function($, GradingEvents, GradingPanel, GradingReviewPanel, GradingActions) {\n\n    var GradingSlider = function(selector_dragbar, selector_main, selector_reviewpanel, selector_gradepanel) {\n        this._dragbar = $(selector_dragbar);\n        this._mainwindow = $(selector_main);\n        this._reviewpanel = $(selector_reviewpanel);\n        this._gradepanel = $(selector_gradepanel);\n\n        this.registerEventListeners();\n    };\n\n    GradingSlider.prototype.registerEventListeners = function() {\n        var docElement = $(document);\n\n        var dragbar = $(this._dragbar);\n        var main = $(this._mainwindow);\n        var reviewpanel = $(this._reviewpanel);\n        var gradepanel = $(this._gradepanel);\n\n        dragbar.on('mousedown', function(e) {\n            e.preventDefault();\n\n            var ghostbar = $('<div>',\n                {id:'ghostbar',\n                 css: {\n                    height: 'calc(100% - 145px)',\n                    marginTop: '85px',\n                    cursor: 'col-resize',\n                    top: main.offset().top,\n                    left: main.offset().left\n                }\n            }).appendTo('body');\n\n            docElement.on('mousemove', function(e){\n              ghostbar.css(\"left\",e.pageX);\n            });\n        });\n\n        docElement.on('mouseup', function(e){\n            if ($('#ghostbar').length) {\n                this.resetPanels();\n                var mainWidth = e.pageX;\n\n                if (e.pageX < 850) {\n                    reviewpanel.addClass('wrapToolbar');\n                    if (e.pageX < 550) {\n                        mainWidth = 550;\n                    }\n                } else if (window.innerWidth - e.pageX < 250) {\n                    mainWidth = window.innerWidth - 250;\n                } else {\n                    reviewpanel.removeClass('wrapToolbar');\n                }\n\n                var percentage = (mainWidth / window.innerWidth) * 100;\n                var mainPercentage = 100-percentage;\n\n                reviewpanel.css(\"right\",mainPercentage + \"%\");\n                gradepanel.css(\"left\",percentage + \"%\");\n                gradepanel.css(\"width\",mainPercentage + \"%\");\n                $('#ghostbar').remove();\n                docElement.unbind('mousemove');\n            }\n        }.bind(this));\n\n        docElement.on(GradingEvents.COLLAPSE_GRADE_PANEL, function() {\n            this.resetAdjustments();\n        }.bind(this));\n\n        docElement.on(GradingEvents.COLLAPSE_REVIEW_PANEL, function() {\n            this.resetAdjustments();\n        }.bind(this));\n\n        docElement.on(GradingEvents.EXPAND_GRADE_PANEL, function() {\n            this.resetAdjustments();\n        }.bind(this));\n    };\n\n    GradingSlider.prototype.resetPanels = function () {\n        GradingReviewPanel.prototype.expandPanel();\n        GradingPanel.prototype.expandPanel();\n        GradingActions.prototype.resetLayoutButtons();\n        GradingActions.prototype.getExpandAllPanelsButton().addClass('active');\n    };\n\n    GradingSlider.prototype.resetAdjustments = function() {\n        var reviewpanel = $(this._reviewpanel);\n        var gradepanel = $(this._gradepanel);\n\n        reviewpanel.removeClass('wrapToolbar');\n        reviewpanel.removeAttr('style');\n        gradepanel.removeAttr('style');\n        $('#ghostbar').remove();\n    };\n\n    return GradingSlider;\n});\n"],"names":["define","$","GradingEvents","GradingPanel","GradingReviewPanel","GradingActions","GradingSlider","selector_dragbar","selector_main","selector_reviewpanel","selector_gradepanel","_dragbar","_mainwindow","_reviewpanel","_gradepanel","registerEventListeners","prototype","docElement","document","dragbar","this","main","reviewpanel","gradepanel","on","e","preventDefault","ghostbar","id","css","height","marginTop","cursor","top","offset","left","appendTo","pageX","length","resetPanels","mainWidth","addClass","window","innerWidth","removeClass","percentage","mainPercentage","remove","unbind","bind","COLLAPSE_GRADE_PANEL","resetAdjustments","COLLAPSE_REVIEW_PANEL","EXPAND_GRADE_PANEL","expandPanel","resetLayoutButtons","getExpandAllPanelsButton","removeAttr"],"mappings":";;;;;;;;;AAwBAA,mCAAO,CAAC,SAAU,4BAA6B,2BACvC,kCAAmC,+BACpC,SAASC,EAAGC,cAAeC,aAAcC,mBAAoBC,oBAE5DC,cAAgB,SAASC,iBAAkBC,cAAeC,qBAAsBC,0BAC3EC,SAAWV,EAAEM,uBACbK,YAAcX,EAAEO,oBAChBK,aAAeZ,EAAEQ,2BACjBK,YAAcb,EAAES,0BAEhBK,iCAGTT,cAAcU,UAAUD,uBAAyB,eACzCE,WAAahB,EAAEiB,UAEfC,QAAUlB,EAAEmB,KAAKT,UACjBU,KAAOpB,EAAEmB,KAAKR,aACdU,YAAcrB,EAAEmB,KAAKP,cACrBU,WAAatB,EAAEmB,KAAKN,aAExBK,QAAQK,GAAG,aAAa,SAASC,GAC7BA,EAAEC,qBAEEC,SAAW1B,EAAE,QACb,CAAC2B,GAAG,WACHC,IAAK,CACFC,OAAQ,qBACRC,UAAW,OACXC,OAAQ,aACRC,IAAKZ,KAAKa,SAASD,IACnBE,KAAMd,KAAKa,SAASC,QAEzBC,SAAS,QAEZnB,WAAWO,GAAG,aAAa,SAASC,GAClCE,SAASE,IAAI,OAAOJ,EAAEY,aAI5BpB,WAAWO,GAAG,UAAW,SAASC,MAC1BxB,EAAE,aAAaqC,OAAQ,MAClBC,kBACDC,UAAYf,EAAEY,MAEdZ,EAAEY,MAAQ,KACVf,YAAYmB,SAAS,eACjBhB,EAAEY,MAAQ,MACVG,UAAY,MAETE,OAAOC,WAAalB,EAAEY,MAAQ,IACrCG,UAAYE,OAAOC,WAAa,IAEhCrB,YAAYsB,YAAY,mBAGxBC,WAAcL,UAAYE,OAAOC,WAAc,IAC/CG,eAAiB,IAAID,WAEzBvB,YAAYO,IAAI,QAAQiB,eAAiB,KACzCvB,WAAWM,IAAI,OAAOgB,WAAa,KACnCtB,WAAWM,IAAI,QAAQiB,eAAiB,KACxC7C,EAAE,aAAa8C,SACf9B,WAAW+B,OAAO,eAExBC,KAAK7B,OAEPH,WAAWO,GAAGtB,cAAcgD,qBAAsB,gBACzCC,oBACPF,KAAK7B,OAEPH,WAAWO,GAAGtB,cAAckD,sBAAuB,gBAC1CD,oBACPF,KAAK7B,OAEPH,WAAWO,GAAGtB,cAAcmD,mBAAoB,gBACvCF,oBACPF,KAAK7B,QAGXd,cAAcU,UAAUuB,YAAc,WAClCnC,mBAAmBY,UAAUsC,cAC7BnD,aAAaa,UAAUsC,cACvBjD,eAAeW,UAAUuC,qBACzBlD,eAAeW,UAAUwC,2BAA2Bf,SAAS,WAGjEnC,cAAcU,UAAUmC,iBAAmB,eACnC7B,YAAcrB,EAAEmB,KAAKP,cACrBU,WAAatB,EAAEmB,KAAKN,aAExBQ,YAAYsB,YAAY,eACxBtB,YAAYmC,WAAW,SACvBlC,WAAWkC,WAAW,SACtBxD,EAAE,aAAa8C,UAGZzC"}