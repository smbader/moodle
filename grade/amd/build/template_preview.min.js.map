{"version":3,"file":"template_preview.min.js","sources":["../src/template_preview.js"],"sourcesContent":["define([\n    'core/modal_save_cancel',\n    'core/modal_events',\n    'core/templates',\n    'core/str',\n    'core_grades/repository'\n], function(\n    ModalSaveCancel,\n    ModalEvents,\n    Templates,\n    Str,\n    {fetchGradingTemplate}\n) {\n\n    class GradingTemplatePreview {\n        constructor() {\n            this.registerEventListeners();\n        }\n\n        registerEventListeners() {\n            document.addEventListener('click', (event) => {\n                if (event.target.classList.contains('template-preview')) {\n                    const templateId = event.target.getAttribute('data-id');\n                    const targetId = event.target.getAttribute('target-id');\n                    const areaId = event.target.getAttribute('area-id');\n                    const parentUrl = event.target.getAttribute('parent-url');\n                    this.setUpModal(templateId, targetId, areaId, parentUrl);\n                }\n            });\n        }\n\n        async getBody(templateId, targetId, areaId, parentUrl) {\n            const response = await fetchGradingTemplate(targetId, templateId, areaId, parentUrl);\n            return Templates.render('core_grades/template_preview', response);\n        }\n\n        async setUpModal(templateId, targetId, areaId, parentUrl) {\n            const modal = await ModalSaveCancel.create({\n                title: 'Grading template preview',\n                body: '',\n                large: true,\n            });\n            const body = await this.getBody(templateId, targetId, areaId, parentUrl);\n            modal.setBody(body);\n            this.modal = modal;\n            modal.show();\n            Str.get_string('templatepick', 'core_grading')\n                .then((btntext) => {\n                    modal.setSaveButtonText(btntext);\n                });\n            modal.getRoot().on(ModalEvents.save, () => {\n                window.parent.location.href = parentUrl + '&pick=' + templateId;\n            });\n        }\n    }\n\n    return {\n        init: function() {\n            return new GradingTemplatePreview();\n        },\n        rebindButtons: function() {\n            GradingTemplatePreview.prototype.registerEventListeners();\n        }\n    };\n});\n"],"names":["define","ModalSaveCancel","ModalEvents","Templates","Str","fetchGradingTemplate","GradingTemplatePreview","constructor","registerEventListeners","document","addEventListener","event","target","classList","contains","templateId","getAttribute","targetId","areaId","parentUrl","setUpModal","response","render","modal","create","title","body","large","this","getBody","setBody","show","get_string","then","btntext","setSaveButtonText","getRoot","on","save","window","parent","location","href","init","rebindButtons","prototype"],"mappings":"AAAAA,sCAAO,CACH,yBACA,oBACA,iBACA,WACA,2BACD,SACCC,gBACAC,YACAC,UACAC,cACAC,qBAACA,iCAGKC,uBACFC,mBACSC,yBAGTA,yBACIC,SAASC,iBAAiB,SAAUC,WAC5BA,MAAMC,OAAOC,UAAUC,SAAS,oBAAqB,OAC/CC,WAAaJ,MAAMC,OAAOI,aAAa,WACvCC,SAAWN,MAAMC,OAAOI,aAAa,aACrCE,OAASP,MAAMC,OAAOI,aAAa,WACnCG,UAAYR,MAAMC,OAAOI,aAAa,mBACvCI,WAAWL,WAAYE,SAAUC,OAAQC,6BAK5CJ,WAAYE,SAAUC,OAAQC,iBAClCE,eAAiBhB,qBAAqBY,SAAUF,WAAYG,OAAQC,kBACnEhB,UAAUmB,OAAO,+BAAgCD,2BAG3CN,WAAYE,SAAUC,OAAQC,iBACrCI,YAActB,gBAAgBuB,OAAO,CACvCC,MAAO,2BACPC,KAAM,GACNC,OAAO,IAELD,WAAaE,KAAKC,QAAQd,WAAYE,SAAUC,OAAQC,WAC9DI,MAAMO,QAAQJ,WACTH,MAAQA,MACbA,MAAMQ,OACN3B,IAAI4B,WAAW,eAAgB,gBAC1BC,MAAMC,UACHX,MAAMY,kBAAkBD,YAEhCX,MAAMa,UAAUC,GAAGnC,YAAYoC,MAAM,KACjCC,OAAOC,OAAOC,SAASC,KAAOvB,UAAY,SAAWJ,qBAK1D,CACH4B,KAAM,kBACK,IAAIrC,wBAEfsC,cAAe,WACXtC,uBAAuBuC,UAAUrC"}